registerChannelProviderLocal firstTime true
#
# ------>-----> snip ----->------> 
#
# Please Use Version and other environment variables
# in order to report or debug this shell
#
# The IOC is started at "2020-W07-Feb14-1058-21-CET"
#
# Version information:
# European Spallation Source ERIC : iocsh.bash (0.5.1-81d1214.PID-12434)
#
# HOSTDISPLAY=""
# WINDOWID=""
# PWD="/home/dev/projects/e3-ecmccfg/ecmccfg-dev/examples/test/el6224"
# USER="dev"
# LOGNAME="dev"
# EPICS_HOST_ARCH="linux-x86_64"
# EPICS_BASE="/epics/base-7.0.3.1"
# E3_REQUIRE_NAME="require"
# E3_REQUIRE_VERSION="3.1.2"
# E3_REQUIRE_LOCATION="/epics/base-7.0.3.1/require/3.1.2"
# E3_REQUIRE_BIN="/epics/base-7.0.3.1/require/3.1.2/bin"
# E3_REQUIRE_DB="/epics/base-7.0.3.1/require/3.1.2/db"
# E3_REQUIRE_DBD="/epics/base-7.0.3.1/require/3.1.2/dbd"
# E3_REQUIRE_INC="/epics/base-7.0.3.1/require/3.1.2/include"
# E3_REQUIRE_LIB="/epics/base-7.0.3.1/require/3.1.2/lib"
# E3_SITEAPPS_PATH="/epics/base-7.0.3.1/require/3.1.2/siteApps"
# E3_SITELIBS_PATH="/epics/base-7.0.3.1/require/3.1.2/siteLibs"
# E3_SITEMODS_PATH="/epics/base-7.0.3.1/require/3.1.2/siteMods"
# EPICS_DRIVER_PATH="/epics/base-7.0.3.1/require/3.1.2/siteMods:/epics/base-7.0.3.1/require/3.1.2/siteApps"
# EPICS_CA_AUTO_ADDR_LIST=""
# EPICS_CA_ADDR_LIST=""
# PATH="/epics/base-7.0.3.1/require/3.1.2/bin:/epics/base-7.0.3.1/bin/linux-x86_64:/home/dev/programs/root/bin:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin:/home/dev/.local/bin:/home/dev/bin"
# LD_LIBRARY_PATH="/epics/base-7.0.3.1/lib/linux-x86_64:/epics/base-7.0.3.1/require/3.1.2/lib/linux-x86_64:/epics/base-7.0.3.1/require/3.1.2/siteLibs/linux-x86_64:/home/dev/programs/root/lib/root"
#
# ------>-----> snip ----->------> 
#
# Set REQUIRE_IOC for its internal PVs
epicsEnvSet REQUIRE_IOC "REQMOD:81d1214-mcag-ep-12434"
#
# Enable an exit subroutine.
dbLoadRecords "/epics/base-7.0.3.1/db/softIocExit.db" "IOC=REQMOD:81d1214-mcag-ep-12434"
#
# Set E3_IOCSH_TOP for the absolute path where iocsh.bash is executed.
epicsEnvSet E3_IOCSH_TOP "/home/dev/projects/e3-ecmccfg/ecmccfg-dev/examples/test/el6224"
# 
# Load require module, which has the version 3.1.2
# 
dlload /epics/base-7.0.3.1/require/3.1.2/lib/linux-x86_64/librequire.so
dbLoadDatabase /epics/base-7.0.3.1/require/3.1.2/dbd/require.dbd
require_registerRecordDeviceDriver
Loading module info records for require
# 
# Set E3_CMD_TOP for the absolute path where el6224.script exists
epicsEnvSet E3_CMD_TOP "/home/dev/projects/e3-ecmccfg/ecmccfg-dev/examples/test/el6224"
#
iocshLoad 'el6224.script',''
##############################################################################
## Example config for el6224 I/O link master
##############################################################################
## Initiation:
epicsEnvSet("IOC" ,"IOC_TEST")
epicsEnvSet("ECMCCFG_INIT" ,"")  #Only run startup once (auto at PSI, need call at ESS), variable set to "#" in startup.cmd
epicsEnvSet("SCRIPTEXEC" ,"iocshLoad")
require ecmccfg anders_io_link
Module ecmccfg version anders_io_link found in /epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/
Module ecmccfg has no library
Loading module info records for ecmccfg
# run module startup.cmd (only needed at ESS  PSI auto call at require)
iocshLoad /epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/startup.cmd, "IOC=IOC_TEST,ECMC_VER=master,stream_VER=2.8.10"
################################################################################
require ecmc        "master"
Module ecmc version master found in /epics/base-7.0.3.1/require/3.1.2/siteMods/ecmc/master/
Module ecmc depends on asyn 4.36.0
Module asyn version 4.36.0 found in /epics/base-7.0.3.1/require/3.1.2/siteMods/asyn/4.36.0/
Loading library /epics/base-7.0.3.1/require/3.1.2/siteMods/asyn/4.36.0/lib/linux-x86_64/libasyn.so
Loaded asyn version 4.36.0
Loading dbd file /epics/base-7.0.3.1/require/3.1.2/siteMods/asyn/4.36.0/dbd/asyn.dbd
Calling function asyn_registerRecordDeviceDriver
Loading module info records for asyn
Module ecmc depends on exprtk 1.2.0
Module exprtk version 1.2.0 found in /epics/base-7.0.3.1/require/3.1.2/siteMods/exprtk/1.2.0/
Loading library /epics/base-7.0.3.1/require/3.1.2/siteMods/exprtk/1.2.0/lib/linux-x86_64/libexprtk.so
Loaded exprtk version 1.2.0
exprtk has no dbd file
Loading module info records for exprtk
Module ecmc depends on motor 7.0.1
Module motor version 7.0.1 found in /epics/base-7.0.3.1/require/3.1.2/siteMods/motor/7.0.1/
Module motor depends on asyn 4.36.0
Module asyn version 4.36.0 already loaded
Loading library /epics/base-7.0.3.1/require/3.1.2/siteMods/motor/7.0.1/lib/linux-x86_64/libmotor.so
Loaded motor version 7.0.1
Loading dbd file /epics/base-7.0.3.1/require/3.1.2/siteMods/motor/7.0.1/dbd/motor.dbd
Calling function motor_registerRecordDeviceDriver
Loading module info records for motor
Loading library /epics/base-7.0.3.1/require/3.1.2/siteMods/ecmc/master/lib/linux-x86_64/libecmc.so
Loaded ecmc version master
Loading dbd file /epics/base-7.0.3.1/require/3.1.2/siteMods/ecmc/master/dbd/ecmc.dbd
Calling function ecmc_registerRecordDeviceDriver
Loading module info records for ecmc
#require EthercatMC  "${EthercatMC_VER=3.0}"
require stream      "2.8.10"
Module stream version 2.8.10 found in /epics/base-7.0.3.1/require/3.1.2/siteMods/stream/2.8.10/
Module stream depends on asyn 4.36.0
Module asyn version 4.36.0 already loaded
Module stream depends on calc 3.7.3
Module calc version 3.7.3 found in /epics/base-7.0.3.1/require/3.1.2/siteMods/calc/3.7.3/
Module calc depends on sequencer 2.2.7
Module sequencer version 2.2.7 found in /epics/base-7.0.3.1/require/3.1.2/siteMods/sequencer/2.2.7/
Loading library /epics/base-7.0.3.1/require/3.1.2/siteMods/sequencer/2.2.7/lib/linux-x86_64/libsequencer.so
Loaded sequencer version 2.2.7
sequencer has no dbd file
Loading module info records for sequencer
Module calc depends on sscan 2.11.3
Module sscan version 2.11.3 found in /epics/base-7.0.3.1/require/3.1.2/siteMods/sscan/2.11.3/
Module sscan depends on sequencer 2.2.7
Module sequencer version 2.2.7 already loaded
Loading library /epics/base-7.0.3.1/require/3.1.2/siteMods/sscan/2.11.3/lib/linux-x86_64/libsscan.so
Loaded sscan version 2.11.3
Loading dbd file /epics/base-7.0.3.1/require/3.1.2/siteMods/sscan/2.11.3/dbd/sscan.dbd
Calling function sscan_registerRecordDeviceDriver
Loading module info records for sscan
Loading library /epics/base-7.0.3.1/require/3.1.2/siteMods/calc/3.7.3/lib/linux-x86_64/libcalc.so
Loaded calc version 3.7.3
Loading dbd file /epics/base-7.0.3.1/require/3.1.2/siteMods/calc/3.7.3/dbd/calc.dbd
Calling function calc_registerRecordDeviceDriver
Loading module info records for calc
Module stream depends on pcre 8.41.0
Module pcre version 8.41.0 found in /epics/base-7.0.3.1/require/3.1.2/siteMods/pcre/8.41.0/
Loading library /epics/base-7.0.3.1/require/3.1.2/siteMods/pcre/8.41.0/lib/linux-x86_64/libpcre.so
Loaded pcre version 8.41.0
pcre has no dbd file
Loading module info records for pcre
Loading library /epics/base-7.0.3.1/require/3.1.2/siteMods/stream/2.8.10/lib/linux-x86_64/libstream.so
Loaded stream version 2.8.10
Loading dbd file /epics/base-7.0.3.1/require/3.1.2/siteMods/stream/2.8.10/dbd/stream.dbd
Calling function stream_registerRecordDeviceDriver
Loading module info records for stream
epicsEnvSet("ECMC_CONFIG_ROOT",     "/epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/")
epicsEnvSet("ECMC_CONFIG_DB",       "/epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/db/")
#epicsEnvSet("EthercatMC_DB",        "${EthercatMC_TEMPLATES}/")
epicsEnvSet("STREAM_PROTOCOL_PATH", ":/epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/:/epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/db")
epicsEnvSet("SCRIPTEXEC",           "iocshLoad")
epicsEnvSet("SM_PREFIX",            "IOC_TEST:")    # colon added since IOC is _not_ PREFIX
iocshLoad "/epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/initAll.cmd"
#==============================================================================
# initAll.cmd
iocshLoad /epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/init.cmd
#==============================================================================
# init.cmd
epicsEnvSet("ECMC_ASYN_TIMEOUT",      1)                   # Asyn timeout
epicsEnvSet("ECMC_ASYN_ADDR",         0)                   # Asyn Address
epicsEnvSet("ECMC_MOTOR_PORT",        "NOT SET")
epicsEnvSet("ECMC_ASYN_PORT",         "NOT SET")
epicsEnvSet("ECMC_PREFIX",            "NOT SET")
epicsEnvSet("ECMC_GEN_EC_RECORDS",    "NOT SET")
epicsEnvSet("ECMC_GEN_AX_RECORDS",    "NOT SET")
epicsEnvSet("ECMC_EC_AXIS_HEALTH",    "NOT SET")
epicsEnvSet("ECMC_PLC_SAMPLE_RATE_MS", "NOT SET")
epicsEnvSet("ECMC_TSE",               -2)
iocshLoad "/epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/initAxis.cmd"
#==============================================================================
# initAxis.cmd
epicsEnvSet("ECMC_MOTOR_NAME",            "NOT SET")
epicsEnvSet("ECMC_R",                     "NOT SET")
epicsEnvSet("ECMC_AXIS_NO",               "NOT SET")
epicsEnvSet("ECMC_DESC",                  "NOT SET")
epicsEnvSet("ECMC_EGU",                   "NOT SET")       # Motor Record Unit
epicsEnvSet("ECMC_PREC",                  "NOT SET")       # Motor Record Precision
epicsEnvSet("ECMC_AXISCONFIG",            "NOT SET")       # Extra parameters to driver
epicsEnvSet("ECMC_EC_AXIS_HEALTH",        "NOT SET")       # Entry for axis health output (example: ec0.s1.BO_1.0)
epicsEnvSet("ECMC_ENC_SCALE_NUM",         "NOT SET")
epicsEnvSet("ECMC_ENC_SCALE_DENOM",       "NOT SET")
epicsEnvSet("ECMC_ENC_BITS",              "NOT SET")
epicsEnvSet("ECMC_ENC_TYPE",              "NOT SET")       # Type: 0=Incremental, 1=Absolute
epicsEnvSet("ECMC_EC_ENC_ACTPOS",         "NOT SET")       # Ethercat entry for actual position input (encoder)
epicsEnvSet("ECMC_ENC_ABS_BITS",          "NOT SET")       # Absolute bit count (for absolute encoders) always least significant part
epicsEnvSet("ECMC_ENC_ABS_OFFSET",        "NOT SET")       # Encoder offset in eng units (for absolute encoders)
epicsEnvSet("ECMC_EC_ENC_LATCHPOS",       "")              # Ethercat entry for latch position (only valid for home seq 11,12)
epicsEnvSet("ECMC_EC_ENC_LATCH_CONTROL",  "")              # Ethercat entry for latch control (only valid for home seq 11,12)
epicsEnvSet("ECMC_EC_ENC_LATCH_STATUS",   "")              # Ethercat entry for latch status (only valid for home seq 11,12)
epicsEnvSet("ECMC_DRV_SCALE_NUM",         "NOT SET")
epicsEnvSet("ECMC_DRV_SCALE_DENOM",       "NOT SET")
epicsEnvSet("ECMC_EC_DRV_CONTROL",        "NOT SET")       # Ethercat entry for control word or bit output
epicsEnvSet("ECMC_EC_DRV_STATUS",         "NOT SET")       # Ethercat entry for status word or bit input
epicsEnvSet("ECMC_EC_DRV_VELOCITY",       "NOT SET")       # Ethercat entry for velocity setpoint output
epicsEnvSet("ECMC_EC_DRV_BRAKE",          "NOT SET")       # Ethercat entry for brake output
epicsEnvSet("ECMC_EC_DRV_REDUCE_TORQUE",  "NOT SET")       # Ethercat entry for reduce torque output
epicsEnvSet("ECMC_DRV_BRAKE_OPEN_DLY_TIME",    "NOT SET")  # Brake timing parameter in cycles (default 1kHz)
epicsEnvSet("ECMC_DRV_BRAKE_CLOSE_AHEAD_TIME", "NOT SET")  # Brake timing parameter in cycles (default 1kHz)
epicsEnvSet("ECMC_VELO",                  "NOT SET")
epicsEnvSet("ECMC_JOG_VEL",               "NOT SET")
epicsEnvSet("ECMC_JAR",                   "NOT SET")       # JAR defaults to VELO/ACCL
epicsEnvSet("ECMC_ACCL",                  "NOT SET")
epicsEnvSet("ECMC_EMERG_DECEL",           "NOT SET")       # Emergency deceleration
epicsEnvSet("ECMC_MRES",                  "NOT SET")
epicsEnvSet("ECMC_HOME_PROC",              "NOT SET")
epicsEnvSet("ECMC_HOME_POS",               "NOT SET")
epicsEnvSet("ECMC_HOME_VEL_TO",            "NOT SET")
epicsEnvSet("ECMC_HOME_VEL_FRM",           "NOT SET")
epicsEnvSet("ECMC_HOME_ACC",               "NOT SET")
epicsEnvSet("ECMC_HOME_DEC",               "NOT SET")
epicsEnvSet("ECMC_HOME_LATCH_COUNT_OFFSET","0")
epicsEnvSet("ECMC_CNTRL_KP",              "NOT SET")
epicsEnvSet("ECMC_CNTRL_KI",              "NOT SET")
epicsEnvSet("ECMC_CNTRL_KD",              "NOT SET")
epicsEnvSet("ECMC_CNTRL_KF2020/02/14 10:58:21.369 
ECMC Initializes.............
2020/02/14 10:58:21.369 ESS Open Source EtherCAT Motion Control Epics Module2020/02/14 10:58:21.369 
Mode: Configuration
2020/02/14 10:58:21.369 OK
2020/02/14 10:58:21.369 OK
2020/02/14 10:58:21.370 OK
2020/02/14 10:58:21.370 OK
2020/02/14 10:58:21.400 OK
F",             "NOT SET")
epicsEnvSet("ECMC_EC_MON_LOWLIM",         "NOT SET")       #  Ethercat entry for low limit switch input
epicsEnvSet("ECMC_EC_MON_HIGHLIM",        "NOT SET")       #  Ethercat entry for high limit switch inpuit
epicsEnvSet("ECMC_EC_MON_HOME_SWITCH",    "NOT SET")       #  Ethercat entry for home switch input
epicsEnvSet("ECMC_EC_MON_EXT_INTERLOCK",  "NOT SET")       #  Ethercat entry for external interlock input
epicsEnvSet("ECMC_SOFT_LOW_LIM",          "NOT SET")
epicsEnvSet("ECMC_SOFT_HIGH_LIM",         "NOT SET")
epicsEnvSet("ECMC_DXLM_ENABLE",           "NOT SET")
epicsEnvSet("ECMC_MON_LAG_MON_TOL",       "NOT SET")
epicsEnvSet("ECMC_MON_LAG_MON_TIME",      "NOT SET")
epicsEnvSet("ECMC_MON_LAG_MON_ENA",       "NOT SET")
epicsEnvSet("ECMC_MON_AT_TARGET_TOL",     "NOT SET")
epicsEnvSet("ECMC_MON_AT_TARGET_TIME",    "NOT SET")
epicsEnvSet("ECMC_MON_AT_TARGET_ENA",     "NOT SET")
epicsEnvSet("ECMC_MON_VELO_MAX",          "NOT SET")
epicsEnvSet("ECMC_MON_VELO_MAX_TRAJ_TIME","NOT SET")
epicsEnvSet("ECMC_MON_VELO_MAX_DRV_TIME", "NOT SET")
epicsEnvSet("ECMC_MON_VELO_MAX_ENA",      "NOT SET")
epicsEnvSet("ECMC_EGU",               "mm")
epicsEnvSet("ECMC_PREC",              3)
epicsEnvSet("ECMCAXISFIELDINIT",      "")                  # Extra field init to motor record
epicsEnvSet("ECMC_AXISCONFIG",        "")                  # Extra parameters to driver
############################################################
############# ASYN Configuration:
epicsEnvSet("ECMC_MOTOR_PORT"     "MCU1")
epicsEnvSet("ECMC_ASYN_PORT"      "MC_CPU1")
epicsEnvSet("ECMC_PREFIX"         "IOC_TEST:")
ecmcAsynPortDriverConfigure(MC_CPU1,1000,0,0,100)
ecmcAsynPortDriverConfigure: portName = MC_CPU1, paramTableSize = 1000, disableAutoConnect = 0, priority = 0, defaultSampleRateMS = 100.000000
asynOctetSetOutputEos(MC_CPU1, -1, ";\n")
asynOctetSetInputEos(MC_CPU1, -1, ";\n")
asynSetTraceMask(MC_CPU1, -1, 0x41)
asynSetTraceIOMask(MC_CPU1, -1, 6)
asynSetTraceInfoMask(MC_CPU1, -1, 1)
ecmcMotorRecordCreateController(MCU1, MC_CPU1, "64", 200, 1000, "")
############################################################
############# Misc settings:
# Disable function call trace printouts
ecmcConfigOrDie "Cfg.SetEnableFuncCallDiag(0)"
# Disable on change printouts from objects (enable for easy logging)
ecmcConfigOrDie "Cfg.SetTraceMaskBit(15,0)"
# Choose to generate EPICS-records for EtherCAT-entries
# (For records use ECMC_GEN_EC_RECORDS="-records" otherwise ECMC_GEN_EC_RECORDS="")
epicsEnvSet("ECMC_GEN_EC_RECORDS",          "-records")
# Choose to generate EPICS-records for ax-entries (PosAct, SetPos,..)
# (For records use ECMC_GEN_AX_RECORDS="-records" otherwise ECMC_GEN_AX_RECORDS="")
epicsEnvSet("ECMC_GEN_AX_RECORDS",          "-records")
# Update records in 10ms (100Hz)
epicsEnvSet("ECMC_SAMPLE_RATE_MS",       "10")
iocshLoad "/epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/addMaster.cmd", "MASTER_ID=0"
#===============================================================================
# addMaster.cfg
epicsEnvSet("ECMC_EC_MASTER_ID"          "0")
# Claim master
ecmcConfigOrDie "Cfg.EcSetMaster(0)"
epicsEnvSet("ECMCCFG_INIT" ,"#")
##############################################################################
## Config hardware:
epicsEnvSet("ECMC_EC_SLAVE_NUM",              "1")
iocshLoad /epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/addSlave.cmd, "SLAVE_ID=1, HW_DESC=EL6224"
#==============================================================================
# addSlave.cmd
epicsEnvSet("ECMC_EC_SLAVE_NUM",  "1")
epicsEnvSet("HW_DESC",            "EL6224")
# add ${HW_DESC} to the bus at position ${SLAVE_ID}
iocshLoad /epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/ecmcEL6224.cmd
epicsEnvSet("ECMC_EC_HWTYPE"             "EL6224")
epicsEnvSet("ECMC_EC_VENDOR_ID"          "0x2")
epicsEnvSet("ECMC_EC_PRODUCT_ID"         "0x18503052")
ecmcConfigOrDie "Cfg.EcSlaveVerify(0,1,0x2,0x18503052)"
ecmcConfigOrDie "Cfg.EcWriteSdo(1,0x1011,0x1,1684107116,4)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(1,0x2,0x18502020/02/14 10:58:21.400 OK
2020/02/14 10:58:21.400 OK
2020/02/14 10:58:21.401 OK
2020/02/14 10:58:21.401 OK
2020/02/14 10:58:21.401 OK
2020/02/14 10:58:21.401 OK
dbLoadTemplate: error opening sub file ecmcEL6224.substitutions: No such file or directory
macLib: macro 1+1 is undefined (expanding string epicsEnvSet("SLAVE_ID",           "$(${ECMC_EC_SLAVE_NUM}+1)"))
2020/02/14 10:58:21.401 OK
2020/02/14 10:58:21.401 OK
2020/02/14 10:58:21.402 OK
2020/02/14 10:58:21.402 OK
2020/02/14 10:58:21.402 OK
2020/02/14 10:58:21.402 OK
2020/02/14 10:58:21.402 OK
2020/02/14 10:58:21.402 OK
2020/02/14 10:58:21.402 OK
2020/02/14 10:58:21.402 OK
2020/02/14 10:58:21.402 OK
2020/02/14 10:58:21.403 OK
2020/02/14 10:58:21.403 OK
2020/02/14 10:58:21.403 OK
2020/02/14 10:58:21.403 OK
3052,2,3,0x1a05,0xf101,0x0D,B1,DEV_DIAG)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(1,0x2,0x18503052,2,3,0x1a05,0xf101,0x10,B1,DEV_STATE)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(1,0x2,0x18503052,2,3,0x1a04,0xf100,0x01,U8,CH1_STATUS)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(1,0x2,0x18503052,2,3,0x1a04,0xf100,0x02,U8,CH2_STATUS)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(1,0x2,0x18503052,2,3,0x1a04,0xf100,0x03,U8,CH3_STATUS)"
ecmcConfigOrDie "Cfg.EcAddEntryDT(1,0x2,0x18503052,2,3,0x1a04,0xf100,0x04,U8,CH4_STATUS)"
dbLoadTemplate(ecmcEL6224.substitutions,"P=IOC_TEST:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=1,HWTYPE=EL6224,T_SMP_MS=10,TSE=-2")
# increment SLAVE_ID
# Example of default configuration of digital input CH 0
epicsEnvSet("ECMC_EC_CH_ID",         "0")
epicsEnvSet("ECMC_EC_CH_ID_TEXT",    "1")
iocshLoad /epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/ecmcEL6224-Sensor-chX_input.cmd
ecmcConfigOrDie "Cfg.EcAddEntryDT(1,0x2,0x18503052,2,3,0x1A00,0x6000,0x01,U8,BI_1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x4")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8000,0x4,0,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x5")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8000,0x5,0,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x20")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8000,0x20,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x21")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8000,0x21,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x22")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8000,0x22,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x23")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8000,0x23,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x24")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8000,0x24,1,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x25")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8000,0x25,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x26")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8000,0x26,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x28")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8000,0x28,1,2)"
dbLoadRecords(ecmcEL1XXX.template,"P=IOC_TEST:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=1,HWTYPE=EL6224,T_SMP_MS=10,TSE=-2,CH_ID=1")
# Example of default configuration of digital input CH 0
epicsEnvSet("ECMC_EC_CH_ID",         "1")
epicsEnvSet("ECMC_EC_CH_ID_TEXT",    "2")
iocshLoad /epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/ecmcEL6224-Sensor-chX_input.cmd
ecmcConfigOrDie "Cfg.EcAddEntryDT(1,0x2,0x18503052,2,3,0x1A01,0x6010,0x01,U8,BI_2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x4")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8010,0x4,0,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x5")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8010,0x5,0,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x20")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8010,0x20,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x21")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie 2020/02/14 10:58:21.403 OK
2020/02/14 10:58:21.403 OK
2020/02/14 10:58:21.403 OK
2020/02/14 10:58:21.403 OK
2020/02/14 10:58:21.403 OK
2020/02/14 10:58:21.403 OK
2020/02/14 10:58:21.403 OK
2020/02/14 10:58:21.404 OK
2020/02/14 10:58:21.404 OK
2020/02/14 10:58:21.404 OK
2020/02/14 10:58:21.404 OK
2020/02/14 10:58:21.404 OK
2020/02/14 10:58:21.404 OK
2020/02/14 10:58:21.404 OK
2020/02/14 10:58:21.404 OK
2020/02/14 10:58:21.404 OK
2020/02/14 10:58:21.405 OK
2020/02/14 10:58:21.405 OK
2020/02/14 10:58:21.406 OK
"Cfg.EcAddSdo(1,0x8010,0x21,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x22")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8010,0x22,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x23")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8010,0x23,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x24")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8010,0x24,1,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x25")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8010,0x25,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x26")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8010,0x26,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x28")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8010,0x28,1,2)"
dbLoadRecords(ecmcEL1XXX.template,"P=IOC_TEST:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=1,HWTYPE=EL6224,T_SMP_MS=10,TSE=-2,CH_ID=2")
# Example of default configuration of digital input CH 0
epicsEnvSet("ECMC_EC_CH_ID",         "2")
epicsEnvSet("ECMC_EC_CH_ID_TEXT",    "3")
iocshLoad /epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/ecmcEL6224-Sensor-chX_input.cmd
ecmcConfigOrDie "Cfg.EcAddEntryDT(1,0x2,0x18503052,2,3,0x1A02,0x6020,0x01,U8,BI_3)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x4")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8020,0x4,0,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x5")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8020,0x5,0,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x20")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8020,0x20,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x21")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8020,0x21,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x22")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8020,0x22,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x23")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8020,0x23,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x24")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8020,0x24,1,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x25")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8020,0x25,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x26")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8020,0x26,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x28")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8020,0x28,1,2)"
dbLoadRecords(ecmcEL1XXX.template,"P=IOC_TEST:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=1,HWTYPE=EL6224,T_SMP_MS=10,TSE=-2,CH_ID=3")
# Example of default configuration of digital input CH 0
epicsEnvSet("ECMC_EC_CH_ID",         "3")
epicsEnvSet("ECMC_EC_CH_ID_TEXT",    "4")
iocshLoad /epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/ecmcEL6224-Sensor-chX_input.cmd
ecmcConfigOrDie "Cfg.EcAddEntryDT(1,0x2,0x18503052,2,3,0x1A03,0x6030,0x01,U8,BI_4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x4")
epicsEnv2020/02/14 10:58:21.406 OK
2020/02/14 10:58:21.406 OK
2020/02/14 10:58:21.406 OK
2020/02/14 10:58:21.406 OK
2020/02/14 10:58:21.406 OK
2020/02/14 10:58:21.406 OK
2020/02/14 10:58:21.407 OK
2020/02/14 10:58:21.407 OK
2020/02/14 10:58:21.407 OK
2020/02/14 10:58:21.407 OK
2020/02/14 10:58:21.407 OK
2020/02/14 10:58:21.407 OK
2020/02/14 10:58:21.407 OK
2020/02/14 10:58:21.407 OK
2020/02/14 10:58:21.407 OK
2020/02/14 10:58:21.407 OK
2020/02/14 10:58:21.407 OK
2020/02/14 10:58:21.409 INFO: Locking memory
2020/02/14 10:58:21.409 WARNING: mlockall() failed (0x20045).
epicsMutex pthread_mutex_unlock epicsMutexOsdUnlock failed: error Operation not permitted
2020/02/14 10:58:21.414 Starting up EtherCAT bus: 0 second(s).
2020/02/14 10:58:21.459 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:373: ERROR: Slave 1: Not operational (0x24011).
2020/02/14 10:58:21.459 ../devEcmcSup/ethercat/ecmcEcSlave.cpp/checkConfigState:378: ERROR_EC_SLAVE_NOT_OPERATIONAL (0x24011).
2020/02/14 10:58:22.415 ../devEcmcSup/main/ecmcError.cpp/errorReset:103: NO_ERROR (0x0).
2020/02/14 10:58:23.415 EtherCAT bus started!
2020/02/14 10:58:23.415 OK
2020/02/14 10:58:23.415 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAtIocBuild (0). Allow callbacks: true.
Starting iocInit
2020/02/14 10:58:23.415 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAtBeginning (1). Allow callbacks: true.
2020/02/14 10:58:23.416 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterCallbackInit (2). Allow callbacks: true.
2020/02/14 10:58:23.416 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterCaLinkInit (3). Allow callbacks: true.
2020/02/14 10:58:23.416 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitDrvSup (4). Allow callbacks: true.
2020/02/14 10:58:23.416 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitRecSup (5). Allow callbacks: true.
2020/02/14 10:58:23.416 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitDevSup (6). Allow callbacks: true.
2020/02/14 10:58:23.417 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.error.reset linked to record (asyn reason 1).
2020/02/14 10:58:23.417 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.error.msg linked to record (asyn reason 2).
2020/02/14 10:58:23.417 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.updated linked to record (asyn reason 3).
2020/02/14 10:58:23.417 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.masterstatus linked to record (asyn reason 4).
2020/02/14 10:58:23.417 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.slavecounter linked to record (asyn reason 5).
2020/02/14 10:58:23.417 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.memmapcounter linked to record (asyn reason 6).
2020/02/14 10:58:23.417 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.domainfailcountertotal linked to record (asyn reason 7).
2020/02/14 10:58:23.417 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.entrycounter linked to record (asyn reason 8).
2020/02/14 10:58:23.418 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.domainstatus linked to record (asyn reason 9).
2020/02/14 10:58:23.418 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s1.BI_1 linked to record (asyn reason 10).
2020/02/14 10:58:23.418 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s1.BI_2 linked to record (asyn reason 11).
2020/02/14 10:58:23.418 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s1.BI_3 linked to record (asyn reason 12).
2020/02/14 10:58:23.418 ecmcAsynPortDriver:drvUserCreate: Parameter ec0.s1.BI_4 linked to record (asyn reason 13).
2020/02/14 10:58:23.418 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.appmode linked to record (asyn reason 14).
2020/02/14 10:58:23.419 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.error.id linked to record (asyn reason 15).
2020/02/14 10:58:23.419 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.latency.min linked to record (asyn reason 16).
2020/02/14 10:58:23.419 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.latency.max linked to record (asyn reason 17).
2020/02/14 10:58:23.419 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.period.min linked to record (asyn reason 18).
2020/02/14 10:58:23.419 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.period.max linked to record (asyn reason 19).
2020/02/14 10:58:23.420 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.execute.min linked to record (asyn reason 20).
2020/02/14 10:58:23.420 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.execute.max linked to record (asyn reason 21).
2020/02/14 10:58:23.420 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.send.min linked to record (asyn reason 22).
2020/02/14 10:58:23.420 ecmcAsynPortDriver:drvUserCreate: Parameter ecmc.thread.send.max linked to record (asyn reason 23).
2020/02/14 10:58:23.421 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitDatabase (7). Allow callbacks: true.
2020/02/14 10:58:23.421 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterFinishDevSup (8). Allow callbacks: true.
2020/02/14 10:58:23.922 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterScanInit (9). Allow callbacks: true.
2020/02/14 10:58:23.922 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInitialProcess (10). Allow callbacks: true.
2020/02/14 10:58:23.923 ecmcAsynPortDriver:getEpicsState: EPICS state: Unknown state (11). Allow callbacks: true.
2020/02/14 10:58:23.923 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterIocBuilt (12). Allow callbacks: true.
2020/02/14 10:58:23.923 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAtIocRun (13). Allow callbacks: true.
2020/02/14 10:58:23.923 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterDatabaseRunning (14). Allow callbacks: true.
2020/02/14 10:58:23.923 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterInterruptAccept (21). Allow callbacks: true.
2020/02/14 10:58:23.923 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterCaServerRunning (15). Allow callbacks: true.
2020/02/14 10:58:23.923 ecmcAsynPortDriver:getEpicsState: EPICS state: Unknown state (22). Allow callbacks: true.
iocRun: All initialization complete
2020/02/14 10:58:23.924 ecmcAsynPortDriver:getEpicsState: EPICS state: initHookAfterIocRunning (16). Allow callbacks: true.
Set("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8030,0x4,0,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x5")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "4")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8030,0x5,0,4)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x20")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8030,0x20,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x21")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8030,0x21,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x22")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8030,0x22,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x23")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8030,0x23,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x24")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8030,0x24,1,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x25")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "1")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8030,0x25,0,1)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x26")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "0")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8030,0x26,0,2)"
epicsEnvSet("ECMC_EC_SDO_INDEX_OFFSET",  "0x28")
epicsEnvSet("ECMC_EC_SDO_SIZE",          "2")
epicsEnvSet("ECMC_EC_SDO_VALUE",         "1")
ecmcConfigOrDie "Cfg.EcAddSdo(1,0x8030,0x28,1,2)"
dbLoadRecords(ecmcEL1XXX.template,"P=IOC_TEST:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,SLAVE_POS=1,HWTYPE=EL6224,T_SMP_MS=10,TSE=-2,CH_ID=4")
#Apply hardware configuration
ecmcConfigOrDie "Cfg.EcApplyConfig(1)"
##############################################################################
############# Configure diagnostics:
ecmcConfigOrDie "Cfg.EcSetDiagnostics(1)"
ecmcConfigOrDie "Cfg.EcEnablePrintouts(0)"
ecmcConfigOrDie "Cfg.EcSetDomainFailedCyclesLimit(100)"
# go active
iocshLoad (/epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/setAppMode.cmd)
#==============================================================================
# setAppMode.cmd
iocshLoad /epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/generalDiagnostics.cmd
#==============================================================================
# generalDiagnostics.cmd
ecmcConfigOrDie "Cfg.EcSetDiagnostics(1)"
ecmcConfigOrDie "Cfg.EcEnablePrintouts(0)"
ecmcConfigOrDie "Cfg.EcSetDomainFailedCyclesLimit(100)"
iocshLoad /epics/base-7.0.3.1/require/3.1.2/siteMods/ecmccfg/anders_io_link/general.cmd
#==============================================================================
# general.cmd
dbLoadRecords("ecmcEc.db","P=IOC_TEST:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,MASTER_ID=0,T_SMP_MS=10,TSE=-2")
dbLoadRecords("ecmcGeneral.db","P=IOC_TEST:,PORT=MC_CPU1,ADDR=0,TIMEOUT=1,T_SMP_MS=10,TSE=-2")
# Nice commands for info ecmcReport <level> or asynReport <level>
# ecmcReport 3
ecmcConfigOrDie "Cfg.SetAppMode(1)"
# Set the IOC Prompt String One 
epicsEnvSet IOCSH_PS1 "81d1214-mcag-ep-12434 > "
#
# 
iocInit
############################################################################
## EPICS R7.0.3.1-E3-7.0.3.1-patch
## EPICS Base built Jan  7 2020
############################################################################
[?1034h81d1214-mcag-ep-12434 > dbl
IOC_TEST:MCU-ErrRst
IOC_TEST:ec0-Stat_
IOC_TEST:ec0-Domain-Stat_
REQMOD:81d1214-mcag-ep-12434:MODULES
REQMOD:81d1214-mcag-ep-12434:VERSIONS
REQMOD:81d1214-mcag-ep-12434:MOD_VER
IOC_TEST:MCU-ErrMsg
IOC_TEST:MCU-updated
IOC_TEST:ec0-Stat
IOC_TEST:ec0-slavecounter
IOC_TEST:ec0-memmapcounter
IOC_TEST:ec0-domainfailcountertotal
IOC_TEST:ec0-entrycounter
IOC_TEST:ec0-Domain-Stat
IOC_TEST:ec0-s1-EL6224-BI1
IOC_TEST:ec0-s1-EL6224-BI2
IOC_TEST:ec0-s1-EL6224-BI3
IOC_TEST:ec0-s1-EL6224-BI4
IOC_TEST:ec0-linkup
IOC_TEST:ec0-alstates-init
IOC_TEST:ec0-alstates-preop
IOC_TEST:ec0-alstates-safeop
IOC_TEST:ec0-alstates-op
IOC_TEST:ec0-Domain-redunactive
IOC_TEST:ec0-Domain-WC-zero
IOC_TEST:ec0-Domain-WC-incomplete
IOC_TEST:ec0-Domain-WC-complete
IOC_TEST:ec0-slavesresp
IOC_TEST:ec0-Domain-WC
REQMOD:81d1214-mcag-ep-12434:exit
REQMOD:81d1214-mcag-ep-12434:BaseVersion
REQMOD:81d1214-mcag-ep-12434:require_VER
REQMOD:81d1214-mcag-ep-12434:ecmccfg_VER
REQMOD:81d1214-mcag-ep-12434:asyn_VER
REQMOD:81d1214-mcag-ep-12434:exprtk_VER
REQMOD:81d1214-mcag-ep-12434:motor_VER
REQMOD:81d1214-mcag-ep-12434:ecmc_VER
REQMOD:81d1214-mcag-ep-12434:sequencer_VER
REQMOD:81d1214-mcag-ep-12434:sscan_VER
REQMOD:81d1214-mcag-ep-12434:calc_VER
REQMOD:81d1214-mcag-ep-12434:pcre_VER
REQMOD:81d1214-mcag-ep-12434:stream_VER
IOC_TEST:MCU-app-mode
IOC_TEST:MCU-ErrId
IOC_TEST:MCU-thread-latency-min
IOC_TEST:MCU-thread-latency-max
IOC_TEST:MCU-thread-period-min
IOC_TEST:MCU-thread-period-max
IOC_TEST:MCU-thread-execute-min
IOC_TEST:MCU-thread-execute-max
IOC_TEST:MCU-thread-send-min
IOC_TEST:MCU-thread-send-max
IOC_TEST:MCU-Cmd
81d1214-mcag-ep-12434 > db[K[K